<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Recursive World</title>

  <!-- A-Frame для 3D сцени -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

  <!-- MediaPipe Hands + TensorFlow.js core + Hand Pose Detection -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/hand-pose-detection"></script>

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- 3D сцена (фон білий) -->
  <a-scene background="color: #ffffff">
    <!-- Камера в ригу (щоб було легше рухати всю камеру) -->
    <a-entity id="cameraRig" position="0 1.8 0">
      <a-camera wasd-controls="enabled: true"></a-camera>
    </a-entity>

    <!-- Підлога (легкий сірий) -->
    <a-plane rotation="-90 0 0" width="20" height="20" color="#f5f5f5"></a-plane>

    <!-- Корінь фракталів у центрі сцени -->
    <a-entity id="fractal-root" position="0 0 -6">
      <!-- Дерево Піфагора -->
      <a-entity id="pythagoras-root" visible="false"></a-entity>

      <!-- Ковер Серпінського -->
      <a-entity id="sierpinski-root" visible="false"></a-entity>
    </a-entity>

    <!-- Візуалізація стеку викликів -->
    <a-entity id="call-stack" position="0 0 -3"></a-entity>

    <!-- HUD: показ глибини рекурсії над сценою -->
    <a-entity id="hud-text"
              text="value: depth: -; color: #333; width: 4"
              position="-1 2 -3">
    </a-entity>
  </a-scene>

  <!-- Відео з вебкамери (для ML) -->
  <video id="webcam" autoplay playsinline></video>

  <!-- ГОЛОВНИЙ ЕКРАН (лендінг) -->
  <div id="home-screen">
    <div class="home-card">
      <h1>Recursive World</h1>
      <p class="home-subtitle">
        Інтерактивна візуалізація рекурсії: фрактали + стек викликів + керування жестами.
      </p>

      <div class="home-section">
        <h2>1. Оберіть режим перегляду</h2>
        <div class="button-row">
          <button class="mode-btn" data-mode="both">Дерево + Ковер</button>
          <button class="mode-btn" data-mode="tree">Тільки дерево Піфагора</button>
          <button class="mode-btn" data-mode="carpet">Тільки ковер Серпінського</button>
        </div>
      </div>

      <div class="home-section">
        <h2>2. Як працюють жести</h2>
        <ul class="gestures-list">
          <li><b>Щипок</b>: великий + вказівний пальці в кадрі.</li>
          <li><b>Відстань між пальцями</b> → глибина рекурсії (2–9).</li>
          <li><b>Горизонтальне положення руки</b> (вліво/вправо) → обертання сцени навколо фігури.</li>
        </ul>
      </div>

      <p class="hint">
        Масштаб змінюється <b>колесиком миші</b> на сцені.<br/>
        Якщо камера не працює — дозволь доступ у браузері та відкривай сторінку через
        <code>http://</code> або <code>https://</code>, а не <code>file://</code>.
      </p>
    </div>
  </div>

  <!-- UI ДЛЯ СЦЕНИ (після вибору режиму) -->
  <div id="scene-ui" class="hidden">
    <div class="scene-panel">
      <div class="scene-row">
        <span class="scene-title">Фігура: <span id="scene-mode-label">—</span></span>
        <button id="back-to-menu">Назад до меню</button>
      </div>
      <div class="scene-desc">
        <p><b>Жести:</b> щипок змінює глибину, рух руки вліво/вправо обертає сцену. Масштаб — колесиком миші.</p>
      </div>
      <div class="scene-controls">
        <div class="ctrl-group">
          <label>Обертання сцени: <span id="rot-value">0°</span></label>
          <input type="range" id="rot-slider" min="-180" max="180" step="5" value="0">
        </div>
        <div class="ctrl-group">
          <label>Камера X: <span id="camx-value">0</span></label>
          <input type="range" id="camx-slider" min="-5" max="5" step="0.5" value="0">
        </div>
        <div class="ctrl-group">
          <label>Камера Y: <span id="camy-value">1.8</span></label>
          <input type="range" id="camy-slider" min="0.5" max="5" step="0.1" value="1.8">
        </div>
        <div class="ctrl-group">
          <label>Камера Z: <span id="camz-value">0</span></label>
          <input type="range" id="camz-slider" min="-5" max="5" step="0.5" value="0">
        </div>
      </div>
    </div>
  </div>

  <!-- Основний JS -->
  <script src="main.js"></script>
</body>
</html>
